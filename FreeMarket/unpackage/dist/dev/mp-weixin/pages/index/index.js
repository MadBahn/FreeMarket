"use strict";const o=require("../../common/vendor.js"),a=require("../../cfg.js");if(!Array){const g=o.resolveComponent("uni-nav-bar"),t=o.resolveComponent("uni-card"),c=o.resolveComponent("no-more");(g+t+c)()}const x=()=>"../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js",w=()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js",y=()=>"../../components/no-more/no-more.js";Math||(x+w+y)();const $=o.defineComponent({__name:"index",setup(g){const t=o.ref(!0),c=getApp(),u=o.ref([]),f=o.ref([]),s=o.ref(0),r=o.ref(!0);o.onLoad(()=>{l(!0),_(),console.log("globalData:",c.globalData)}),o.onShow(()=>{console.log("onShow"),t.value=!0,console.log(t.value)}),o.onHide(()=>{console.log("onHide"),t.value=!1,console.log(t.value)}),o.onReachBottom(()=>{console.log("reach bottom"),r.value&&l(!1)}),o.onPullDownRefresh(()=>{console.log("pull down refresh"),_(),l(!0)});function l(n){n&&(s.value=0);const d=4;o.index.request({url:"http://localhost:4000/api/goods/goods_display",method:"POST",data:{filter:{start_at:s.value,amount:d,sub_filter:{}}},success(e){console.log(e.data.data),e.statusCode===200&&(r.value=e.data.data.data.length===d,u.value=n?e.data.data.data:u.value.concat(e.data.data.data),s.value=e.data.data.next_index,console.log(s.value),o.index.stopPullDownRefresh())}})}function _(){o.index.request({url:`${a.cfg.server}:${a.cfg.port}${a.cfg.api.prefix}${a.cfg.api.goods.prefix}${a.cfg.api.goods.hot_goods}`,method:"POST",success(n){n.statusCode===200&&(f.value=n.data)}})}function p(n){o.index.navigateTo({url:"/pages/browse_goods/browse_goods?id="+n.goods_id+"&userid="+getApp().globalData.login.userid})}function m(){o.index.navigateTo({url:"/pages/search/search?type=goods",animationType:"none"})}function h(){o.index.navigateTo({url:"/pages/new_goods/new_goods?operation=new"})}return(n,d)=>o.e({a:o.o(m),b:o.o(h),c:o.p({leftIcon:"plusempty",statusBar:!0,fixed:!0}),d:o.f(f.value,(e,i,v)=>({a:`${o.unref(a.cfg).server}:${o.unref(a.cfg).port}/${e.imgs[0].url}`,b:o.t(e.price),c:o.o(b=>p(e))})),e:o.f(u.value,(e,i,v)=>({a:o.t(e.goods_name),b:o.t(e.price),c:o.o(b=>p(e),i),d:i,e:"1cf27b2a-1-"+v,f:o.p({cover:o.unref(a.cfg).server+":"+o.unref(a.cfg).port+"/"+e.imgs[0].url||""})})),f:!r.value},r.value?{}:{})}}),P=o._export_sfc($,[["__scopeId","data-v-1cf27b2a"],["__file","F:/HBuilderProjects/FreeMarket/pages/index/index.vue"]]);wx.createPage(P);
