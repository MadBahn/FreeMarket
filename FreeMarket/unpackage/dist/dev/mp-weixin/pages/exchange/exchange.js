"use strict";const e=require("../../common/vendor.js"),n=require("../../cfg.js");if(!Array){const g=e.resolveComponent("uni-segmented-control"),c=e.resolveComponent("uni-card"),r=e.resolveComponent("no-more"),a=e.resolveComponent("empty");(g+c+r+a)()}const p=()=>"../../uni_modules/uni-segmented-control/components/uni-segmented-control/uni-segmented-control.js",v=()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js",x=()=>"../../components/no-more/no-more.js",h=()=>"../../components/empty/empty.js";Math||(p+y+v+x+h)();const y=()=>"../../components/goods_unit/goods_unit.js",b=e.defineComponent({__name:"exchange",setup(g){const c=e.ref(""),r=e.ref(0),a=e.ref(0),_=e.ref(["已发起","待支付","待收货","已完成","已取消"]),u=e.ref([]),l=e.ref(!0);e.onLoad(o=>{console.log(o),c.value=o.type,d(!0)}),e.onPullDownRefresh(()=>{d(!0)}),e.onReachBottom(()=>{l.value&&d(!1)});function d(o){console.log(getApp().globalData.login.userid),o&&(r.value=0);const s=4;e.index.request({url:`${n.cfg.server}:${n.cfg.port}${n.cfg.api.prefix}${n.cfg.api.goods.prefix}${n.cfg.api.goods.get_deal}`,method:"POST",data:{userid:getApp().globalData.login.userid,filter:{isSeller:c.value==="seller",amount:s,start_at:r.value,status:a.value}},success(t){console.log(t),t.statusCode===200&&(l.value=t.data.data.data.length===s,r.value=t.data.data.next_index,u.value=o?t.data.data.data:u.value.concat(t.data.data.data),e.index.stopPullDownRefresh())}})}function m(o){const s=c.value==="buyer"?"confirm_exchange":"custom_exchange";e.index.navigateTo({url:`/pages/exchange/${s}/${s}?id=${o}`})}function f(o){console.log(o),a.value=o.currentIndex,o.currentIndex===4&&(a.value=-1),d(!0)}return(o,s)=>e.e({a:e.o(f),b:e.p({current:a.value,values:_.value,styleType:"text"}),c:u.value.length!==0},u.value.length!==0?e.e({d:e.f(u.value,(t,P,i)=>e.e({a:"7fbf46dc-2-"+i+","+("7fbf46dc-1-"+i),b:e.p({data:t.goods_snapshot}),c:e.t(t.price),d:t.status!==-1&&t.status!==3},t.status!==-1&&t.status!==3?{}:{},{e:e.o(j=>m(t.exchange_id)),f:"7fbf46dc-1-"+i,g:e.p({title:typeof t._target!==void 0?t._target.username:t._target,["is-full"]:"true",extra:new Date(t.post_date).toLocaleString(),thumbnail:`${typeof t._target!==void 0?e.unref(n.cfg).server+":"+e.unref(n.cfg).port+"/"+t._target.headImg:e.unref(n.cfg).default_avatar}`})})),e:!l.value},l.value?{}:{}):{})}}),$=e._export_sfc(b,[["__file","F:/HBuilderProjects/FreeMarket/pages/exchange/exchange.vue"]]);wx.createPage($);
