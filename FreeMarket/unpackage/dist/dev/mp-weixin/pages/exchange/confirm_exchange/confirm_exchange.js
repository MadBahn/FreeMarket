"use strict";const e=require("../../../common/vendor.js"),a=require("../../../cfg.js");Array||e.resolveComponent("uni-steps")();const g=()=>"../../../uni_modules/uni-steps/components/uni-steps/uni-steps.js";Math||(f+g)();const f=()=>"../../../components/goods_unit/goods_unit.js",p=e.defineComponent({__name:"confirm_exchange",setup(i){const t=e.ref({}),c=e.reactive({active:0,list:[{title:"已发起"},{title:"待付款"},{title:"待收货"},{title:"已完成"}]});e.onLoad(s=>{n(s.id)});function n(s){e.index.request({url:`${a.cfg.server}:${a.cfg.port}${a.cfg.api.prefix}${a.cfg.api.goods.prefix}${a.cfg.api.goods.deal_info}`,method:"POST",data:{exchange_id:s,type:"seller"},success(o){console.log(o),o.statusCode===200&&(t.value=o.data.data,c.active=t.value.status)}})}function u(){e.index.request({url:`${a.cfg.server}:${a.cfg.port}${a.cfg.api.prefix}${a.cfg.api.goods.prefix}${a.cfg.api.goods.finish_deal}`,method:"POST",data:{finish_form:{exchange_id:t.value.exchange_id}},success(s){console.log(s),s.statusCode===200&&(e.index.navigateBack(),e.index.showToast({icon:"success",title:"交易完成"}))}})}function r(){e.index.showModal({title:"确定",content:"是否取消当前的交易？",success(s){s.cancel||e.index.request({url:`${a.cfg.server}:${a.cfg.port}${a.cfg.api.prefix}${a.cfg.api.goods.prefix}${a.cfg.api.goods.cancel_deal}`,method:"POST",data:{cancel_form:{exchange_id:t.value.exchange_id}},success(o){console.log(o),o.statusCode===200&&(e.index.navigateBack(),e.index.showToast({icon:"success",title:"交易取消成功。"}))}})}})}function l(){e.index.navigateTo({url:`/pages/pay/pay?id=${t.value.exchange_id}&price=${t.value.price}`})}return(s,o)=>e.e({a:`url(${e.unref(a.cfg).server}:${e.unref(a.cfg).port}/${t.value._target.headImg}`,b:e.t(t.value._target.username),c:e.t(new Date(t.value.post_date).toLocaleString()),d:e.p({data:t.value.goods_snapshot}),e:e.t(t.value.price),f:e.p({options:c.list,active:c.active}),g:t.value.status===1},t.value.status===1?{h:e.o(l)}:{},{i:t.value.status===2},t.value.status===2?{j:e.o(d=>u())}:{},{k:t.value.status!==3&&t.value.status!==-1},t.value.status!==3&&t.value.status!==-1?{l:e.o(d=>r())}:{})}}),_=e._export_sfc(p,[["__scopeId","data-v-6617173b"],["__file","F:/HBuilderProjects/FreeMarket/pages/exchange/confirm_exchange/confirm_exchange.vue"]]);wx.createPage(_);
