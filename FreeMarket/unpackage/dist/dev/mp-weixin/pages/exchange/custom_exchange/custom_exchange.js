"use strict";const e=require("../../../common/vendor.js"),n=require("../../../cfg.js");Array||e.resolveComponent("uni-popup")();const g=()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(x+v+g)();const v=()=>"../../../components/price_keypad/price_keypad.js",x=()=>"../../../components/goods_unit/goods_unit.js",m=e.defineComponent({__name:"custom_exchange",setup(r){const a=e.ref({exchange_id:"",price:0});e.ref(!1);const i=e.ref(null),t=e.reactive({index:0,array:["线上支付","卖家确认"]});e.onLoad(o=>{d(o.id)});function d(o){e.index.request({url:`${n.cfg.server}:${n.cfg.port}${n.cfg.api.prefix}${n.cfg.api.goods.prefix}${n.cfg.api.goods.deal_info}`,method:"POST",data:{exchange_id:o,type:"buyer"},success(s){console.log(s),s.statusCode===200&&(a.value=s.data.data)}})}function p(o,s){o===1&&t.index===1?e.index.showModal({title:"三思而后行",content:"请确保与买家协调好，避免造成您的经济损失",success(c){c.cancel||u(o,s)}}):u(o,s)}function u(o,s){e.index.request({url:`${n.cfg.server}:${n.cfg.port}${n.cfg.api.prefix}${n.cfg.api.goods.prefix}${n.cfg.api.goods.proceed_deal}`,method:"POST",data:{proceed_form:{action:o,exchange_id:a.value.exchange_id,isProceed:s,setter:a.value,pay:t.array[t.index]}},success(c){console.log(c),c.statusCode===200&&(e.index.navigateBack(),o===1?e.index.showToast({icon:"success",title:"交易正式确认了"}):e.index.showToast({icon:"success",title:"交易已暂存"}))}})}function l(){i.value.open()}function f(o){a.value.price=1*o,i.value.close()}function _(o){t.index=o.detail.value}return(o,s)=>e.e({a:e.p({data:a.value.goods_snapshot}),b:e.t(a.value.price),c:a.value.status===0},a.value.status===0?{d:e.o(l)}:{},{e:a.value.desc,f:e.o(c=>a.value.desc=c.detail.value),g:e.t(t.array[t.index]),h:e.o(_),i:t.index,j:t.array,k:a.value.status===0},a.value.status===0?{l:e.o(c=>p(0,!1)),m:e.o(c=>p(1,!0))}:{},{n:a.value.status===0},a.value.status===0?{o:e.o(f),p:e.p({price:a.value.price}),q:e.sr(i,"0ba89a34-1",{k:"keypad"}),r:e.p({type:"bottom"})}:{})}}),h=e._export_sfc(m,[["__file","F:/HBuilderProjects/FreeMarket/pages/exchange/custom_exchange/custom_exchange.vue"]]);wx.createPage(h);
