"use strict";const e=require("../../common/vendor.js"),o=require("../../cfg.js");if(!Array){const a=e.resolveComponent("uni-icons"),t=e.resolveComponent("uni-section");(a+t)()}const _=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",g=()=>"../../uni_modules/uni-section/components/uni-section/uni-section.js";Math||(_+x+d+v+g)();const d=()=>"../../components/comment_input/comment_input.js",v=()=>"../../components/comment_display/comment_display.js",x=()=>"../../components/common_report/common_report.js",b=e.defineComponent({__name:"browse_post",setup(a){getApp();const t=e.ref({});e.onLoad(n=>{console.log(n),e.index.showNavigationBarLoading(),u(n)});function r(n){e.index.request({url:`${o.cfg.server}:${o.cfg.port}${o.cfg.api.prefix}${o.cfg.api.user.prefix}${o.cfg.api.user.create_comment}`,method:"POST",data:{comment_form:{content:n,comment_to:t.value.post_id,comment_by:getApp().globalData.login.userid}},success(i){if(i.statusCode===200){const s=i.data;s.comment_by=getApp().globalData.login,t.value.comments.push(s)}}})}function u(n){e.index.request({url:o.cfg.server+":"+o.cfg.port+o.cfg.api.prefix+o.cfg.api.post.prefix+o.cfg.api.post.read_post,method:"POST",data:{post_id:n.id,userid:n.userid},success(i){console.log(i.data.data),i.statusCode===200&&(t.value=i.data.data,e.index.setNavigationBarTitle({title:t.value.title}))},complete(){e.index.hideNavigationBarLoading()}})}function p(){e.index.request({url:o.cfg.server+":"+o.cfg.port+o.cfg.api.prefix+o.cfg.api.user.prefix+o.cfg.api.user.favorite,method:"POST",data:{favorite_form:{userid:getApp().globalData.login.userid,refer_to:t.value.post_id}},success(n){console.log(n),n.statusCode===200&&(e.index.showToast({icon:"success",title:n.data.msg}),t.value.isFavorite=!t.value.isFavorite)}})}function l(){c(t.value.post_id)}function c(n){e.index.navigateTo({url:`/pages/report/report?refer_to=${n}&report_by=${getApp().globalData.login.userid}`})}function m(n){e.index.navigateTo({url:`/pages/info/info?id=${n}`})}return(n,i)=>({a:e.unref(o.cfg).server+":"+e.unref(o.cfg).port+"/"+t.value.post_by.headImg||e.unref(o.cfg).default_avatar,b:e.t(t.value.post_by.username),c:e.t(new Date(t.value.post_date).toLocaleString()),d:e.o(s=>m(t.value.post_by.userid)),e:e.o(p),f:e.p({color:"#1296db",size:"40",type:t.value.isFavorite?"star-filled":"star"}),g:e.f(t.value.imgs,(s,f,h)=>({a:e.unref(o.cfg).server+":"+e.unref(o.cfg).port+"/"+s.url,b:f})),h:e.t(t.value.content),i:e.o(l),j:e.o(r),k:e.o(c),l:e.p({_data:t.value.comments}),m:e.p({id:"comment",titleFontSize:"20px",title:"评论",type:"line"})})}}),y=e._export_sfc(b,[["__file","F:/HBuilderProjects/FreeMarket/pages/browse_post/browse_post.vue"]]);wx.createPage(y);
