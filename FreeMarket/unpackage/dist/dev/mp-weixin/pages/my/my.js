"use strict";const e=require("../../common/vendor.js"),n=require("../../cfg.js");if(!Array){const r=e.resolveComponent("uni-icons"),a=e.resolveComponent("uni-popup");(r+a)()}const _=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",x=()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(_+x)();const h=e.defineComponent({__name:"my",setup(r){const a=e.ref(!1),t=e.ref({}),u=e.ref();e.onLoad(async()=>{c(),Object.keys(t.value).length}),e.index.$on("user",()=>c()),e.index.$on("logout",()=>v());function c(){try{t.value=getApp().globalData.login,console.log(t.value),a.value=Object.keys(t.value).length!==0}catch{}}function i(s){e.index.navigateTo({url:s})}function m(s){e.index.navigateTo({url:`/pages/info/info?id=${s}`})}function d(){u.value.open("bottom")}function f(s){e.index.chooseImage({count:1,sourceType:s,success(p){console.log(p),e.index.uploadFile({url:`${n.cfg.server}:${n.cfg.port}${n.cfg.api.prefix}${n.cfg.api.files.prefix}${n.cfg.api.files.upload_file}`,filePath:p.tempFilePaths[0],name:"file",success(o){if(console.log(o),o.statusCode===200){const y=JSON.parse(o.data)[0].path.split("\\"),g="files\\\\".concat(y[1]);e.index.request({url:`${n.cfg.server}:${n.cfg.port}${n.cfg.api.prefix}${n.cfg.api.user.prefix}${n.cfg.api.user.modify_info}`,method:"POST",data:{modify_form:{userid:getApp().globalData.login.userid,headImg:g}},success(l){console.log(l),l.statusCode===200&&(getApp().globalData.login.headImg=g,e.index.setStorage({key:"user_login",data:l.data,complete(){t.value={},c(),u.value.close()}}))}})}}})}})}function v(){try{e.index.removeStorage({key:"user_login",success(){getApp().globalData.login={},a.value=!1,c()}})}catch{}}return(s,p)=>e.e({a:"url("+(t.value.headImg!==""?e.unref(n.cfg).server+":"+e.unref(n.cfg).port+"/"+t.value.headImg:e.unref(n.cfg).default_avatar)+")",b:e.o(d),c:a.value},a.value?{d:e.t(t.value.username),e:e.t(t.value.desc),f:e.o(o=>m(t.value.userid))}:{g:e.o(o=>i("/pages/login/login"))},{h:e.p({size:"35",customPrefix:"iconfont",type:"icon-favor"}),i:e.o(o=>i("/pages/favorite/favorite")),j:e.p({size:"35",customPrefix:"iconfont",type:"icon-lishi"}),k:e.o(o=>i("/pages/history/history")),l:e.p({size:"35",customPrefix:"iconfont",type:"icon-tiezi"}),m:e.o(o=>i("/pages/mypost/mypost")),n:e.p({size:"35",customPrefix:"iconfont",type:"icon-31quanbushangpin"}),o:e.o(o=>i("/pages/mygoods/mygoods")),p:e.p({size:"35",customPrefix:"iconfont",type:"icon-mairu"}),q:e.o(o=>i("/pages/exchange/exchange?type=buyer")),r:e.p({size:"35",customPrefix:"iconfont",type:"icon-maichu"}),s:e.o(o=>i("/pages/exchange/exchange?type=seller")),t:e.o(o=>i("/pages/settings/settings")),v:e.p({type:"camera-filled",size:"25"}),w:e.o(o=>f(["camera"])),x:e.p({type:"image-filled",size:"25"}),y:e.o(o=>f(["album"])),z:e.sr(u,"2f1ef635-6",{k:"action"})})}}),$=e._export_sfc(h,[["__scopeId","data-v-2f1ef635"],["__file","F:/HBuilderProjects/FreeMarket/pages/my/my.vue"]]);wx.createPage($);
